{% from 'app-components/dashboard-heading.njk' import dashboardHeading %}
{% extends 'layout.njk' %}

{% block page_title %}{{ super() }} - Draft barriers{% endblock %}

{% block modal %}
<div class="modal">
    <div class="modal-box">
        <h3 class="modal-title"> Delete unfinished barrier</h3>
        <p> Are you sure you want to delete this unfinished barrier? </p>
        <dl>
            <dt>Barrier ID </dt>
            <dd>{{ currentReport.id}}</dd>
            <dt>Location</dt>
            <dd>{{ currentReport.export_country}}</dd>
            {% if currentReport.barrier_title %}
                <dt>Barrier title</dt>
                <dd>{{ currentReport.barrier_title}}</dd>
            {% endif %}
            {% if currentReport.product %}
                <dt>Product or service</dt>
                <dd>{{ currentReport.product}}</dd>
            {% endif %}
            
        </dl>
        <form action="{{ urls.reports.delete( report.id ) }}" method="POST">
            <input type="hidden" name="_csrf" value="{{ csrfToken }}">
            <input type="submit" value="Yes, delete" class="govuk-button">
            <a href="{{ urls.reports.index() }}" class="govuk-button button--secondary">No, cancel</a>
	    </form>
    </div>
</div>
{% endblock %}

{% block page_content %}
    
	{{ dashboardHeading( dashboard, isReports = true ) }}

    <table class="standard-table">
        <thead>
            <tr class="standard-table__heading-row">
                <th class="standard-table__heading standard-table__heading--active">Date started</th>
                <th class="standard-table__heading">Barrier ID</th>
                <th class="standard-table__heading">Barrier location</th>
                <th class="standard-table__heading">Resolved?</th>
                <th class="standard-table__heading">Barrier scope</th>
                <th class="standard-table__heading">Started by</th>
                <th class="standard-table__heading">Action</th>
            </tr>
        </thead>
        <tbody>
            {% for report in reports %}
            <tr class="standard-table__row">
                <td class="standard-table__cell">
                    {{ ( report.date.created | dateWithTime ) or '---' }}
                </td>
                <td class="standard-table__cell">
                    {{ report.code }}
                </td>
                <td class="standard-table__cell">
                    {{ report.country.name or '---' }}
                </td>
                <td class="standard-table__cell">
                    {{ 'Yes' if report.isResolved else 'No' }}
                </td>
                <td class="standard-table__cell">
                    {{ report.problem_status.name or '---' }}
                </td>
                <td class="standard-table__cell">
                    {{ report.created_by or '---' }}
                </td>
                <td class="standard-table__cell">
                    <a href="{{ urls.reports.detail( report.id ) }}">Continue</a>
                    <a href="{{ urls.reports.delete( report.id ) }}">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
